<!DOCTYPE html><html lang="ru"><head><meta charset="utf-8"><meta name="author" content="Иван Пономарёв, КУРС/МФТИ"><title>О графике из книги «Проект Феникс»</title><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui" name="viewport"><link href="reveal.js/css/reveal.css" rel="stylesheet"><link rel="stylesheet" href="white_course.css" id="theme"><!--This CSS is generated by the Asciidoctor-Reveal.js converter to further integrate AsciiDoc's existing semantic with Reveal.js--><style type="text/css">.reveal div.right {
  float: right;
}

/* callouts */
.conum[data-value] {display:inline-block;color:#fff!important;background-color:rgba(50,150,50,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]:after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}</style><link rel="stylesheet" href="./font-awesome-4.7.0/css/font-awesome.css"><script type="text/x-mathjax-config">MathJax.Hub.Config({
tex2jax: {
  inlineMath: [["\\(", "\\)"]],
  displayMath: [["\\[", "\\]"]],
  ignoreClass: "nostem|nolatexmath"
},
asciimath2jax: {
  delimiters: [["\\$", "\\$"]],
  ignoreClass: "nostem|noasciimath"
},
TeX: { equationNumbers: { autoNumber: "none" } }
});</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.4.0/MathJax.js?config=TeX-MML-AM_HTMLorMML"></script><link href="reveal.js/lib/css/zenburn.css" rel="stylesheet"><script>var link = document.createElement( 'link' );
link.rel = 'stylesheet';
link.type = 'text/css';
link.href = window.location.search.match( /print-pdf/gi ) ? "reveal.js/css/print/pdf.css" : "reveal.js/css/print/paper.css";
document.getElementsByTagName( 'head' )[0].appendChild( link );</script><!--[if lt IE 9]><script src="reveal.js/lib/js/html5shiv.js"></script><![endif]--></head><body><div class="reveal"><div class="slides"><section class="title" data-state="title"><h1>О графике из книги «Проект Феникс»</h1><div class="preamble"><div class="paragraph"><p><a href="mailto:ponomarev@corchestra.ru">ponomarev@corchestra.ru</a></p></div>
<div class="paragraph"><p><span class="icon"><i class="fa fa-twitter fa-lg"></i></span> @inponomarev</p></div></div><p class="author"><small>Иван Пономарёв, КУРС/МФТИ</small></p></section>
<section id="_кто_читал_эту_книжку"><h2>Кто читал эту книжку?</h2><div class="imageblock" style=""><img src="images/phoenix.jpg" alt="phoenix" width="30%"></div></section>
<section id="_а_кто_знает_про_что_эта_картинка"><h2>А кто знает, про что эта картинка?</h2><div class="imageblock" style=""><img src="images/graph.png" alt="graph" width="60%"></div></section>
<section id="_wtf"><h2>WTF?</h2><div class="ulist"><ul><li><p>Как так вышло, что чем «оптимальнее» загружен процессор, тем медленнее идёт процесс?</p></li><li><p>И почему всё настолько плохо возле точки 100% загрузки процессора?</p></li></ul></div></section>
<section id="_любая_очередь_есть_моделируемый_процесс_подчиняющийся_общим_закономерностям"><h2>Любая очередь есть моделируемый процесс, подчиняющийся общим закономерностям</h2><div class="ulist"><ul><li class="fragment"><p>Очередь из сообщений в топике Kafka,</p></li><li class="fragment"><p>очередь задач в вашей Жире,</p></li><li class="fragment"><p>очередь на кассу в магазин,</p></li></ul></div></section>
<section id="_вообще_любая_очередь"><h2>вообще любая очередь.</h2><div class="imageblock" style=""><img src="images/london-queue.jpg" alt="london queue" width="60%"></div></section>
<section id="_параметры_модели"><h2>Параметры модели</h2><div class="ulist"><ul><li><p>Cредняя частота возникновения событий&#8201;&#8212;&#8201;&lambda;,</p></li><li><p>Средняя пропускная способность обработчика&#8201;&#8212;&#8201;&mu;</p></li><li><p>Загруженность обработчика&#8201;&#8212;&#8201;\(\rho=\frac{\lambda}{\mu}\)</p></li></ul></div></section>
<section id="_получаем_такую_картинку"><h2>Получаем такую картинку</h2><div class="imageblock" style=""><img src="images/othergraph.png" alt="othergraph" width="60%"></div></section>
<section id="_но_почему_не_такую"><h2>Но почему не такую??</h2><div class="imageblock" style=""><img src="images/whynot.png" alt="whynot" width="60%"></div></section>
<section id="_наливаем_себе_пивко_начинается_матан"><h2>Наливаем себе пивко, начинается матан</h2><div class="imageblock" style=""><img src="images/beers.jpg" alt="beers" width="70%"></div></section>
<section id="_модель_самая_простая"><h2>Модель (самая простая)</h2><div class="ulist"><ul><li><p>События становятся в очередь в случайные моменты времени с распределением Пуассона,</p></li><li><p>Обработчик событий затрачивает случайное время с экспоненциальным распределением,</p></li><li><p>Система может находиться в счётном количестве состояний:</p></li></ul></div>
<div class="imageblock" style=""><img src="images/markov.png.png" alt="markov.png"></div></section>
<section id="_вероятность_нахождения_в_состоянии_n_в_момент_времени_t"><h2>Вероятность нахождения в состоянии <em>n</em> в момент времени <em>t</em></h2><div class="imageblock" style=""><img src="images/markov.png.png" alt="markov.png"></div>
<div class="stemblock"><div class="content">\[\huge
\begin{array}{rcl}
p_0(t+\Delta t) &amp; = &amp; (1 - \lambda \Delta t) p_0(t) + \mu \Delta t p_1(t) + o(\Delta t), \\
p_n(t+\Delta t) &amp; = &amp; \lambda \Delta t p_{n-1}(t) + (1 - (\lambda +\mu)\Delta t) p_n(t) \\
&amp; &amp; + \mu \Delta t p_{n+1}(t) + o(\Delta t). \end{array}\]</div></div>
<div class="imageblock" style="text-align: right"><img src="images/kitten-1.jpg" alt="kitten 1" width="20%"></div></section>
<section id="_при_δt_0"><h2>При Δt &#8594; 0</h2><div class="imageblock" style=""><img src="images/markov.png.png" alt="markov.png"></div>
<div class="stemblock"><div class="content">\[\huge
\begin{array}{rcl}
p'_0(t) &amp; = &amp;  - \lambda p_0(t) + \mu p_1(t),\\
p'_n(t) &amp; = &amp; \lambda  p_{n-1}(t) - (\lambda +\mu) p_n(t) + \mu p_{n+1}(t)  \end{array}\]</div></div>
<div class="imageblock" style="text-align: left"><img src="images/kitten-2.jpg" alt="kitten 2" width="30%"></div></section>
<section id="_при_стационарном_поведении_системы"><h2>При стационарном поведении системы</h2><table class="tableblock frame-all grid-all" style="width:100%"><colgroup><col style="width:60%"><col style="width:40%"></colgroup><tbody><tr><td class="tableblock halign-left valign-top"><div><div class="imageblock" style=""><img src="images/markov.png.png" alt="markov.png"></div>
<div class="stemblock"><div class="content">\[\huge
\begin{array}{rcl}
0 &amp; = &amp;  - \lambda p_0 + \mu p_1,\\
0 &amp; = &amp; \lambda  p_{n-1} - (\lambda +\mu) p_n + \mu p_{n+1},\\
1 &amp; = &amp; \sum\limits_{n=0}^{\infty}p_n
\end{array}\]</div></div></div></td><td class="tableblock halign-left valign-top"><div><div class="imageblock" style="text-align: right"><img src="images/kitten-4.jpg" alt="kitten 4" width="70%"></div></div></td></tr></table></section>
<section id="_решение_всей_системы"><h2>Решение всей системы</h2><div class="stemblock"><div class="content">\[\Huge
\begin{array}
&amp;p_n=(1-\rho)\rho^n,\\
n = 0,1,2\ldots, \quad \rho = \frac{\lambda}{\mu}
\end{array}\]</div></div>
<div class="imageblock" style="text-align: center"><img src="images/kitten-5.jpg" alt="kitten 5" width="40%"></div></section>
<section id="_средняя_длина_очереди"><h2>Средняя длина очереди?</h2><div class="stemblock"><div class="content">\[\Huge
\begin{array}
&amp;E(L) = \sum\limits_{n=0}^{\infty}n p_n = \rho(1-\rho)\sum\limits_{n=0}^{\infty}n \rho^{n-1}=\\
= \frac{\rho}{1- \rho}.
\end{array}\]</div></div>
<div class="imageblock" style="text-align: center"><img src="images/kitten-3.jpg" alt="kitten 3" width="30%"></div></section>
<section id="_итак"><h2>Итак&#8230;&#8203;</h2><div class="stemblock"><div class="content">\[\Huge
E(L) = \frac{\rho}{1- \rho}.\]</div></div></section>
<section id="_но_ведь_это"><h2>Но ведь это&#8230;&#8203;</h2><div class="imageblock" style=""><img src="images/graph.png" alt="graph" width="60%"></div></section>
<section id="_на_пальцах_это_можно_объяснить_как_то_так"><h2>На пальцах это можно объяснить как-то так</h2><table class="tableblock frame-all grid-all" style="width:100%"><colgroup><col style="width:50%"><col style="width:50%"></colgroup><tbody><tr><td class="tableblock halign-left valign-top"><div><div class="imageblock" style=""><img src="images/gates.jpg" alt="gates"></div></div></td><td class="tableblock halign-left valign-top"><div><div class="imageblock" style=""><img src="images/othergraph.png" alt="othergraph"></div></div></td></tr></table></section>
<section id="_выводы"><h2>Выводы</h2><div class="paragraph"><p>Любая система с очередью может находиться в одном из трёх режимов</p></div></section>
<section id="_нестабильный_режим"><h2>Нестабильный режим</h2><div class="paragraph"><p>&mu; &lt; &lambda; или &mu; = &lambda; (нам конец)</p></div>
<div class="imageblock" style=""><img src="images/othergraph-1.png" alt="othergraph 1" width="60%"></div></section>
<section id="_режим_с_малым_ожиданием_в_очереди_и_малой_загрузкой_процессора"><h2>Режим с малым ожиданием в очереди (и малой загрузкой процессора)</h2><div class="paragraph"><p>&mu; &gt;&gt; &lambda; (очереди нет, но и процессор часто простаивает)</p></div>
<div class="imageblock" style=""><img src="images/othergraph-2.png" alt="othergraph 2" width="60%"></div></section>
<section id="_возле_точки_насыщения"><h2>Возле точки насыщения</h2><div class="ulist"><ul><li><p>&mu; &gt; &lambda;, но ненамного!</p></li></ul></div>
<div class="imageblock" style=""><img src="images/othergraph-3.png" alt="othergraph 3" width="60%"></div></section>
<section id="_главный_вывод"><h2>Главный вывод</h2><div class="paragraph"><p>Оптимизация процессора и оптимизация потока&#8201;&#8212;&#8201;это «качели»: оптимизируя поток, мы должны лимитировать загрузку процессора.</p></div>
<div class="imageblock" style=""><img src="images/seesaw.jpg" alt="seesaw" width="50%"></div></section>
<section id="_у_меня_всё"><h2>У меня всё!</h2><div class="ulist"><ul><li><p><span class="icon"><i class="fa fa-twitter fa-lg"></i></span>  @inponomarev
&#160;<br></p></li><li><p><span class="icon"><i class="fa fa-envelope fa-lg"></i></span> <a href="mailto:ponomarev@corchestra.ru">ponomarev@corchestra.ru</a>
&#160;<br></p></li></ul></div>
<div class="imageblock" style=""><img src="images/seesaw.jpg" alt="seesaw" width="30%"></div></section></div></div><script src="reveal.js/lib/js/head.min.js"></script><script src="reveal.js/js/reveal.js"></script><script>Array.prototype.slice.call(document.querySelectorAll('.slides section')).forEach(function(slide) {
  if (slide.getAttribute('data-background-color')) return;
  // user needs to explicitly say he wants CSS color to override otherwise we might break custom css or theme (#226)
  if (!(slide.classList.contains('canvas') || slide.classList.contains('background'))) return;
  var bgColor = getComputedStyle(slide).backgroundColor;
  if (bgColor !== 'rgba(0, 0, 0, 0)' && bgColor !== 'transparent') {
    slide.setAttribute('data-background-color', bgColor);
    slide.style.backgroundColor = 'transparent';
  }
})

// See https://github.com/hakimel/reveal.js#configuration for a full list of configuration options
Reveal.initialize({
  // Display presentation control arrows
  controls: true,
  // Help the user learn the controls by providing hints, for example by
  // bouncing the down arrow when they first encounter a vertical slide
  controlsTutorial: true,
  // Determines where controls appear, "edges" or "bottom-right"
  controlsLayout: 'bottom-right',
  // Visibility rule for backwards navigation arrows; "faded", "hidden"
  // or "visible"
  controlsBackArrows: 'faded',
  // Display a presentation progress bar
  progress: true,
  // Display the page number of the current slide
  slideNumber: true,
  // Control which views the slide number displays on
  showSlideNumber: 'all',
  // Push each slide change to the browser history
  history: true,
  // Enable keyboard shortcuts for navigation
  keyboard: true,
  // Enable the slide overview mode
  overview: true,
  // Vertical centering of slides
  center: false,
  // Enables touch navigation on devices with touch input
  touch: true,
  // Loop the presentation
  loop: false,
  // Change the presentation direction to be RTL
  rtl: false,
  // Randomizes the order of slides each time the presentation loads
  shuffle: false,
  // Turns fragments on and off globally
  fragments: true,
  // Flags whether to include the current fragment in the URL,
  // so that reloading brings you to the same fragment position
  fragmentInURL: false,
  // Flags if the presentation is running in an embedded mode,
  // i.e. contained within a limited portion of the screen
  embedded: false,
  // Flags if we should show a help overlay when the questionmark
  // key is pressed
  help: true,
  // Flags if speaker notes should be visible to all viewers
  showNotes: false,
  // Global override for autolaying embedded media (video/audio/iframe)
  // - null: Media will only autoplay if data-autoplay is present
  // - true: All media will autoplay, regardless of individual setting
  // - false: No media will autoplay, regardless of individual setting
  autoPlayMedia: null,
  // Number of milliseconds between automatically proceeding to the
  // next slide, disabled when set to 0, this value can be overwritten
  // by using a data-autoslide attribute on your slides
  autoSlide: 0,
  // Stop auto-sliding after user input
  autoSlideStoppable: true,
  // Use this method for navigation when auto-sliding
  autoSlideMethod: Reveal.navigateNext,
  // Specify the average time in seconds that you think you will spend
  // presenting each slide. This is used to show a pacing timer in the
  // speaker view
  defaultTiming: 120,
  // Enable slide navigation via mouse wheel
  mouseWheel: false,
  // Hides the address bar on mobile devices
  hideAddressBar: true,
  // Opens links in an iframe preview overlay
  // Add `data-preview-link` and `data-preview-link="false"` to customise each link
  // individually
  previewLinks: false,
  // Transition style (e.g., none, fade, slide, convex, concave, zoom)
  transition: 'none',
  // Transition speed (e.g., default, fast, slow)
  transitionSpeed: 'default',
  // Transition style for full page slide backgrounds (e.g., none, fade, slide, convex, concave, zoom)
  backgroundTransition: 'fade',
  // Number of slides away from the current that are visible
  viewDistance: 3,
  // Parallax background image (e.g., "'https://s3.amazonaws.com/hakim-static/reveal-js/reveal-parallax-1.jpg'")
  parallaxBackgroundImage: '',
  // Parallax background size in CSS syntax (e.g., "2100px 900px")
  parallaxBackgroundSize: '',
  // Number of pixels to move the parallax background per slide
  // - Calculated automatically unless specified
  // - Set to 0 to disable movement along an axis
  parallaxBackgroundHorizontal: null,
  parallaxBackgroundVertical: null,
  // The display mode that will be used to show slides
  display: 'block',

  // The "normal" size of the presentation, aspect ratio will be preserved
  // when the presentation is scaled to fit different resolutions. Can be
  // specified using percentage units.
  width: 1600,
  height: 900,

  // Factor of the display size that should remain empty around the content
  margin: 0.1,

  // Bounds for smallest/largest possible scale to apply to content
  minScale: 0.2,
  maxScale: 1.5,

  // Optional libraries used to extend on reveal.js
  dependencies: [
      { src: 'reveal.js/lib/js/classList.js', condition: function() { return !document.body.classList; } },
      { src: 'reveal.js/plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
      { src: 'reveal.js/plugin/zoom-js/zoom.js', async: true },
      { src: 'reveal.js/plugin/notes/notes.js', async: true },
      
      
      
      
  ],

  

});</script></body></html>